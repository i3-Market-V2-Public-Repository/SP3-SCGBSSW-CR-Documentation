<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="906px" preserveAspectRatio="none" style="width:999px;height:906px;background:#FFFFFF;" version="1.1" viewBox="0 0 999 906" width="999px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="DejaVu Sans" font-size="18" lengthAdjust="spacing" textLength="338" x="328.25" y="28.708">i3-MARKET conflict resolution: dispute</text><rect fill="#FFFFFF" height="859.9688" style="stroke:#A80036;stroke-width:1.0;" width="165" x="1" y="40.9531"/><text fill="#000000" font-family="DejaVu Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105" x="31" y="53.02">i3M Consumer</text><rect fill="#FBFBFF" height="859.9688" style="stroke:#A80036;stroke-width:1.0;" width="604.5" x="389" y="40.9531"/><text fill="#000000" font-family="DejaVu Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108" x="637.25" y="53.02">i3M Backplane</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="0" x="693.75" y="68.1528"/><rect fill="#FFFFFF" height="386.2578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484.5" y="446.0703"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="924.5" y="490.3359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="83" x2="83" y1="122.8125" y2="850.3281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="489" x2="489" y1="122.8125" y2="850.3281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="929.5" x2="929.5" y1="122.8125" y2="850.3281"/><rect fill="#99FF99" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="157" x="5" y="91.5156"/><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="143" x="12" y="111.5107">Consumer: SDA SDK</text><rect fill="#99FF99" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="157" x="5" y="849.3281"/><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="143" x="12" y="869.3232">Consumer: SDA SDK</text><rect fill="#A9A9FF" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="193" x="393" y="75.2188"/><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="97" x="441" y="95.2139">Backplane API</text><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="179" x="400" y="111.5107">: Conflict-Resolver Service</text><rect fill="#A9A9FF" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="193" x="393" y="849.3281"/><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="97" x="441" y="869.3232">Backplane API</text><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="179" x="400" y="885.6201">: Conflict-Resolver Service</text><rect fill="#FEFECE" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="869.5" y="91.5156"/><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="106" x="876.5" y="111.5107">i3-MARKET DLT</text><rect fill="#FEFECE" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="869.5" y="849.3281"/><text fill="#000000" font-family="DejaVu Sans" font-size="14" lengthAdjust="spacing" textLength="106" x="876.5" y="869.3232">i3-MARKET DLT</text><rect fill="#FFFFFF" height="386.2578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484.5" y="446.0703"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="924.5" y="490.3359"/><path d="M88,137.8125 L88,252.8125 L395,252.8125 L395,147.8125 L385,137.8125 L88,137.8125 " fill="#E9FFE9" style="stroke:#A80036;stroke-width:1.0;"/><path d="M385,137.8125 L385,147.8125 L395,147.8125 L385,137.8125 " fill="#E9FFE9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="286" x="94" y="154.8794">If after a completed non-repudiation protocol</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="257" x="94" y="170.0122">a consumer cannot properly decrypt the</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="264" x="94" y="185.145">cipherblock with the published secret, the</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="262" x="94" y="200.2778">consumer can initiate a dispute so that it</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="275" x="94" y="215.4106">gets a signed resolution made by a trusted</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="273" x="94" y="230.5435">third party proving that the the cipherblock</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="204" x="94" y="245.6763">cannot effectively be decrypted.</text><line style="stroke:#A80036;stroke-width:1.0;" x1="83.5" x2="125.5" y1="403.9375" y2="403.9375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="125.5" x2="125.5" y1="403.9375" y2="416.9375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="84.5" x2="125.5" y1="416.9375" y2="416.9375"/><polygon fill="#A80036" points="94.5,412.9375,84.5,416.9375,94.5,420.9375,90.5,416.9375" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="216" x="90.5" y="274.8091">create disputeRequest = JWS</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="10" lengthAdjust="spacing" textLength="48" x="306.5" y="278.5166">consumer</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="16" x="354.5" y="274.8091">({</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="160" x="106.5" y="292.9419">proofType: 'request'</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="88" x="106.5" y="308.0747">iss: 'dest'</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="320" x="106.5" y="323.2075">iat: number // NumericDate for issued at</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="312" x="106.5" y="338.3403">por: string // the PoR as a compact JWS</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="176" x="106.5" y="353.4731">dataExchangeId: string</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="176" x="106.5" y="368.606">type: 'disputeRequest'</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="376" x="106.5" y="383.7388">cipherblock: string // the cipherblock as a JWE</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="16" x="90.5" y="398.8716">})</text><polygon fill="#A80036" points="472.5,442.0703,482.5,446.0703,472.5,450.0703,476.5,446.0703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="83.5" x2="478.5" y1="446.0703" y2="446.0703"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="256" x="90.5" y="441.0044">POST /dispute { disputeRequest }</text><polygon fill="#A80036" points="912.5,486.3359,922.5,490.3359,912.5,494.3359,916.5,490.3359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="494.5" x2="918.5" y1="490.3359" y2="490.3359"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="352" x="501.5" y="470.1372">getSecret (por.exchange.ledgerSignerAddress,</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="128" x="501.5" y="485.27">por.exchange.id)</text><polygon fill="#A80036" points="505.5,515.4688,495.5,519.4688,505.5,523.4688,501.5,519.4688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="499.5" x2="928.5" y1="519.4688" y2="519.4688"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="168" x="511.5" y="514.4028">{ secret, secretIat }</text><line style="stroke:#A80036;stroke-width:1.0;" x1="494.5" x2="536.5" y1="566.7344" y2="566.7344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="536.5" x2="536.5" y1="566.7344" y2="579.7344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="495.5" x2="536.5" y1="579.7344" y2="579.7344"/><polygon fill="#A80036" points="505.5,575.7344,495.5,579.7344,505.5,583.7344,501.5,579.7344" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="256" x="501.5" y="543.5356">decrypt cipherblock with secret:</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="144" x="517.5" y="558.6685">decryptedBlock=Dec</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="10" lengthAdjust="spacing" textLength="36" x="661.5" y="562.376">secret</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="104" x="697.5" y="558.6685">(cipherblock)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="494.5" x2="536.5" y1="624" y2="624"/><line style="stroke:#A80036;stroke-width:1.0;" x1="536.5" x2="536.5" y1="624" y2="637"/><line style="stroke:#A80036;stroke-width:1.0;" x1="495.5" x2="536.5" y1="637" y2="637"/><polygon fill="#A80036" points="505.5,633,495.5,637,505.5,641,501.5,637" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="112" x="501.5" y="603.8013">validate that:</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="328" x="517.5" y="618.9341">decryptedBlock meets  PoO.exchange.schema</text><line style="stroke:#A80036;stroke-width:1.0;" x1="494.5" x2="536.5" y1="790.1953" y2="790.1953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="536.5" x2="536.5" y1="790.1953" y2="803.1953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="495.5" x2="536.5" y1="803.1953" y2="803.1953"/><polygon fill="#A80036" points="505.5,799.1953,495.5,803.1953,505.5,807.1953,501.5,803.1953" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="176" x="501.5" y="661.0669">signedResolution = JWS</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="10" lengthAdjust="spacing" textLength="18" x="677.5" y="664.7744">CRS</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="16" x="695.5" y="661.0669">({</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="184" x="517.5" y="679.1997">proofType: 'resolution'</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="120" x="517.5" y="694.3325">type: 'dispute'</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="264" x="517.5" y="709.4653">resolution: 'accepted' | 'denied'</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="400" x="517.5" y="724.5981">dataExchangeId: disputeRequest.por.poo.exchange.id</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="240" x="517.5" y="739.731">iat: number // NumericDate now</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="376" x="517.5" y="754.8638">iss: string // the public key of the CRS in JWK</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="360" x="517.5" y="769.9966">sub: string // the public JWK of the consumer</text><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="16" x="501.5" y="785.1294">})</text><path d="M213,700.3984 L213,755.3984 L479,755.3984 L479,710.3984 L469,700.3984 L213,700.3984 " fill="#E9E9FF" style="stroke:#A80036;stroke-width:1.0;"/><path d="M469,700.3984 L469,710.3984 L479,710.3984 L469,700.3984 " fill="#E9E9FF" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="245" x="219" y="717.4653">Resolution is 'denied' if the cipherblock</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="236" x="219" y="732.5981">can be properly decrypted; otherwise</text><text fill="#000000" font-family="DejaVu Sans" font-size="13" lengthAdjust="spacing" textLength="83" x="219" y="747.731">is 'accepted'.</text><polygon fill="#A80036" points="94.5,828.3281,84.5,832.3281,94.5,836.3281,90.5,832.3281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="88.5" x2="488.5" y1="832.3281" y2="832.3281"/><text fill="#000000" font-family="DejaVu Sans Mono" font-size="13" lengthAdjust="spacing" textLength="160" x="100.5" y="827.2622">{ signedResolution }</text><!--MD5=[9f37f290afc935f20ecc874584756663]
@startuml conflictDispute
skinparam shadowing false
skinparam DefaultFontName DejaVu Sans
skinparam DefaultMonospacedFontName DejaVu Sans Mono
skinparam ArrowFontName DejaVu Sans Mono
skinparam maxMessageSize 460

title "i3-MARKET conflict resolution: dispute"

box "i3M Consumer" #White
  participant "Consumer: SDA SDK" as C #99FF99
end box
box "i3M Backplane\n" #FBFBFF
  participant "Backplane API\n: Conflict-Resolver Service" as CRS #A9A9FF
  participant "i3-MARKET DLT" as DLT
end box

note right of C #E9FFE9
  If after a completed non-repudiation protocol
  a consumer cannot properly decrypt the
  cipherblock with the published secret, the
  consumer can initiate a dispute so that it 
  gets a signed resolution made by a trusted
  third party proving that the the cipherblock
  cannot effectively be decrypted.
end note

C->C: create disputeRequest = JWS<sub>consumer</sub>({\n  proofType: 'request'\n  iss: 'dest'\n  iat: number // NumericDate for issued at\n  por: string // the PoR as a compact JWS\n  dataExchangeId: string\n  type: 'disputeRequest'\n  cipherblock: string // the cipherblock as a JWE\n})
C->CRS++: POST /dispute { disputeRequest }

CRS->DLT++: getSecret (por.exchange.ledgerSignerAddress, por.exchange.id)
return { secret, secretIat }

CRS->CRS: decrypt cipherblock with secret:\n  decryptedBlock=Dec<sub>secret</sub>(cipherblock)

CRS->CRS: validate that:\n  decryptedBlock meets  PoO.exchange.schema

CRS->CRS: signedResolution = JWS<sub>CRS</sub>({\n  proofType: 'resolution'\n  type: 'dispute'\n  resolution: 'accepted' | 'denied'\n  dataExchangeId: disputeRequest.por.poo.exchange.id\n  iat: number // NumericDate now\n  iss: string // the public key of the CRS in JWK\n  sub: string // the public JWK of the consumer\n})
note left #E9E9FF
  Resolution is 'denied' if the cipherblock
  can be properly decrypted; otherwise 
  is 'accepted'.
end note
return { signedResolution }


@enduml

PlantUML version 1.2021.16(Wed Dec 08 18:25:22 CET 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>